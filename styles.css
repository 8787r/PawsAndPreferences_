:root{
  --bg: #ffe6ee;
  --card-bg: #fff;
  --text: #222;
  --muted: #666;
  --accent-like: #4ccc93;
  --accent-dislike: #e5566d;
  --btn-shadow: rgba(0,0,0,0.12);
}

/* dark mode */
body.dark{
  --bg: #0f1113;
  --card-bg: #111214;
  --text: #eee;
  --muted: #aaa;
}

*{box-sizing: border-box}
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: var(--bg);
  color: var(--text);
  display: flex;
  justify-content: center;
  padding: 18px;
  min-height: 100vh;
}

/* app container */
#app{
  width: 100%;
  max-width: 420px;
}

/* header */
.header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:8px;
}
.header h1{
  margin: 0;
  font-size: 1.2rem;
  text-align:left;
}
.controls-top button{
  background: transparent;
  border: none;
  font-size: 1.1rem;
  cursor: pointer;
}

/* progress line (top) */
#progress-wrap{
  width: 100%;
  height: 6px;
  background: rgba(0,0,0,0.06);
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 12px;
}
#progress-line{
  height:100%;
  width: 0%;
  background: linear-gradient(90deg,var(--accent-like), #7be2b6);
  transition: width 300ms ease;
}

/* card container */
#card-container {
  position: relative;
  width: 100%;
  /* FIX: Make height responsive to viewport and set limits */
  height: 60vh; 
  min-height: 380px; 
  max-height: 500px;
  margin: 0 auto;
  touch-action: pan-y;
  -webkit-tap-highlight-color: transparent;
}

/* each card */
.card {
  position: absolute;
  width: 90%;
  /* FIX: Make card height relative to container */
  height: 95%; 
  left: 50%;
  top: 0;
  transform: translateX(-50%);
  border-radius: 16px;
  background: var(--card-bg);
  background-size: cover;
  background-position: center;
  box-shadow: 0 8px 22px var(--btn-shadow);
  transition: transform 260ms cubic-bezier(.22,.9,.3,1), opacity 200ms;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  overflow: hidden;
}

/* stacked offset for visible depth - FIXED: use :nth-last-child() */
.card:nth-last-child(2){ transform: translateX(-50%) translateY(8px) scale(0.99); }
.card:nth-last-child(3){ transform: translateX(-50%) translateY(16px) scale(0.98); }

/* overlay label */
.label {
  position: absolute;
  top: 18px;
  padding: 8px 14px;
  border-radius: 8px;
  font-weight: 700;
  font-size: 1.1rem;
  opacity: 0;
  transform: rotate(-12deg);
  pointer-events: none;
}
.label.like{
  left: 16px;
  background: rgba(76,204,147,0.12);
  color: var(--accent-like);
  border: 2px solid rgba(76,204,147,0.9);
}
.label.dislike{
  right: 16px;
  transform: rotate(12deg);
  background: rgba(229,86,109,0.12);
  color: var(--accent-dislike);
  border: 2px solid rgba(229,86,109,0.9);
}

/* actions (buttons) */
#actions{
  display:flex;
  justify-content:center;
  gap: 18px;
  margin-top: 14px;
  margin-bottom: 8px;
}
.action-btn{
  width:64px;
  height:64px;
  border-radius: 999px;
  border: none;
  background: var(--card-bg);
  box-shadow: 0 8px 18px var(--btn-shadow);
  font-size: 1.5rem;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition: transform 120ms ease, box-shadow 120ms;
}
.action-btn:active{ transform: scale(.96); }
/* Add style for disabled undo button */
.action-btn:disabled{ opacity: 0.5; cursor: not-allowed; transform: none; } 

.like-btn{ background: linear-gradient(180deg,var(--accent-like), #2fbf7a); color:white;}
.dislike-btn{ background: linear-gradient(180deg,#f06a77,var(--accent-dislike)); color:white; }
#undo{ font-size:1.2rem; }

/* small progress text */
#progress.text{
  text-align:center;
  margin-top:4px;
  color:var(--muted);
  font-size:0.95rem;
}

/* summary */
.hidden{ display:none; }
#summary{ text-align:center; margin-top:18px; }
.liked-grid{ display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:10px; }
.liked-grid img{ width:100px; height:100px; object-fit:cover; border-radius:8px; box-shadow: 0 6px 14px rgba(0,0,0,0.12); }

/* restart */
.summary-actions{ margin-top:12px; }
.summary-actions button{ padding:8px 14px; border-radius:8px; border:none; background:#444; color:white; cursor:pointer; }

/* responsive tweaks */
@media (max-width:420px){
  /* Height handled by min-height on container */
  .card{ width:92%; } 
  #card-container{ min-height: 380px; }
  .action-btn{ width:56px; height:56px; }
}
